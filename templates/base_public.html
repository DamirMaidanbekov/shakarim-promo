{% load i18n %}
{% load static %}
{% get_current_language as LANGUAGE_CODE %}

<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% trans "Admission 2026 - Shakarim University" %}</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/collapse@3.x.x/dist/cdn.min.js"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    
    <!-- GSAP for Animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    
    <!-- Three.js & Vanta for 3D Background -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.net.min.js"></script>
    
    <!-- Tilt.js for 3D Cards -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.8.0/vanilla-tilt.min.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Space Grotesk', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            900: '#0c4a6e',
                        },
                        dark: {
                            800: '#1e293b',
                            900: '#0f172a',
                            950: '#020617',
                        }
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; }
        h1, h2, h3, h4, h5, h6 { font-family: 'Space Grotesk', sans-serif; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        .dark ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .dark ::-webkit-scrollbar-thumb { background: #334155; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        .dark ::-webkit-scrollbar-thumb:hover { background: #475569; }

        /* Glassmorphism Configuration */
        .glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.05);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.05);
        }
        .dark .glass {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }
        
        .glass-nav {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }
        .dark .glass-nav {
            background: rgba(15, 23, 42, 0.7);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.05);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.05);
        }
        .dark .glass-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.01) 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }
        
        .text-glow {
            text-shadow: 0 0 40px rgba(56, 189, 248, 0.3);
        }
        .dark .text-glow {
            text-shadow: 0 0 40px rgba(56, 189, 248, 0.5);
        }
        
        .card-hover:hover {
            box-shadow: 0 0 30px rgba(56, 189, 248, 0.2);
            border-color: rgba(56, 189, 248, 0.3);
        }

        /* Input Autofill Fix */
        input:-webkit-autofill,
        input:-webkit-autofill:hover, 
        input:-webkit-autofill:focus, 
        input:-webkit-autofill:active{
            -webkit-box-shadow: 0 0 0 30px white inset !important;
        }
        .dark input:-webkit-autofill,
        .dark input:-webkit-autofill:hover, 
        .dark input:-webkit-autofill:focus, 
        .dark input:-webkit-autofill:active{
            -webkit-box-shadow: 0 0 0 30px #1e293b inset !important;
            -webkit-text-fill-color: white !important;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 dark:bg-dark-950 dark:text-gray-100 antialiased overflow-x-hidden selection:bg-brand-500 selection:text-white transition-colors duration-300">

    <!-- 3D Background Container (Vanta) -->
    <div id="vanta-canvas" class="fixed inset-0 z-0 opacity-40 pointer-events-none transition-colors duration-500"></div>
    
    <!-- Ambient Gradients -->
    <div class="fixed top-0 left-0 w-full h-full overflow-hidden -z-10 pointer-events-none">
        <div class="absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-blue-400/10 dark:bg-blue-600/20 rounded-full blur-[120px] animate-pulse-slow"></div>
        <div class="absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-purple-400/10 dark:bg-purple-600/10 rounded-full blur-[120px] animate-pulse-slow" style="animation-delay: 2s;"></div>
    </div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass-nav transition-all duration-300" id="navbar">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#" class="flex items-center gap-3 group">
                <div class="w-10 h-10 rounded-xl bg-gradient-to-tr from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-xl shadow-lg shadow-blue-500/30 group-hover:scale-110 transition-transform duration-300">
                    S
                </div>
                <span class="font-display font-bold text-xl tracking-tight text-slate-800 dark:text-white">Shakarim <span class="text-blue-600 dark:text-blue-400">University</span></span>
            </a>

            <div class="hidden md:flex items-center gap-8 text-sm font-medium text-gray-600 dark:text-gray-300">
                <a href="#admission" class="hover:text-blue-600 dark:hover:text-white transition-colors relative group">
                    Поступление
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-blue-500 transition-all group-hover:w-full"></span>
                </a>
                <a href="#programs" class="hover:text-blue-600 dark:hover:text-white transition-colors relative group">
                    Программы
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-blue-500 transition-all group-hover:w-full"></span>
                </a>
                <a href="#tuition" class="hover:text-blue-600 dark:hover:text-white transition-colors relative group">
                    Стоимость
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-blue-500 transition-all group-hover:w-full"></span>
                </a>
                <a href="#faq" class="hover:text-blue-600 dark:hover:text-white transition-colors relative group">
                    FAQ
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-blue-500 transition-all group-hover:w-full"></span>
                </a>
                
            </div>

            <div class="flex items-center gap-4">
                <!-- Theme Toggle -->
                <button onclick="toggleTheme()" class="p-2 rounded-lg hover:bg-black/5 dark:hover:bg-white/10 text-gray-600 dark:text-gray-300 transition-colors">
                    <svg id="sun-icon" class="w-5 h-5 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                    <svg id="moon-icon" class="w-5 h-5 block dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
                </button>

                <div class="hidden sm:flex text-xs font-bold bg-black/5 dark:bg-white/5 rounded-lg p-1">
                    {% get_available_languages as LANGUAGES %}
                    {% for lang_code, lang_name in LANGUAGES %}
                        <a href="/{{ lang_code }}/" class="px-3 py-1 rounded-md transition-all {% if lang_code == LANGUAGE_CODE %}bg-blue-600 text-white shadow-lg{% else %}hover:bg-black/5 dark:hover:bg-white/10 text-gray-500 dark:text-gray-400{% endif %} uppercase">
                            {{ lang_code }}
                        </a>
                    {% endfor %}
                </div>
                {% if user.is_authenticated %}
                <a href="{% url 'applicants:dashboard' %}" class="relative px-6 py-2.5 rounded-xl font-bold text-sm bg-slate-900 dark:bg-white text-white dark:text-dark-950 hover:bg-slate-800 dark:hover:bg-blue-50 transition-colors shadow-lg overflow-hidden group flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                    <span class="relative z-10">{% trans "Личный кабинет" %}</span>
                </a>
                {% else %}
                <a href="{% url 'applicants:register' %}" class="relative px-6 py-2.5 rounded-xl font-bold text-sm bg-slate-900 dark:bg-white text-white dark:text-dark-950 hover:bg-slate-800 dark:hover:bg-blue-50 transition-colors shadow-lg overflow-hidden group flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"></path></svg>
                    <span class="relative z-10">{% trans "Регистрация" %}</span>
                </a>
                {% endif %}
            </div>
        </div>
    </nav>

    {% block content %}
    {% endblock %}
    <!-- Footer -->
    <footer class="relative pt-20 pb-10 border-t border-gray-200 dark:border-white/10 transition-colors duration-300 bg-white dark:bg-dark-900">
        <div class="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 pointer-events-none mix-blend-overlay"></div>
        <div class="container mx-auto px-4 relative z-10">
            <div class="grid md:grid-cols-4 gap-12 mb-16">
                <div class="col-span-1 md:col-span-2">
                    <h2 class="text-3xl font-display font-bold mb-6 text-slate-900 dark:text-white">Shakarim University</h2>
                    <p class="text-gray-500 max-w-sm mb-6">Ведущий центр образования, науки и инноваций. Создаем будущее вместе с 1934 года.</p>
                </div>
                
                <div>
                    <h4 class="font-bold mb-4 text-slate-900 dark:text-white">Контакты</h4>
                    <ul class="space-y-3 text-gray-500 dark:text-gray-400 text-sm">
                        <li>{{ config.address }}</li>
                        <li><a href="tel:{{ config.phone }}" class="hover:text-blue-500">{{ config.phone }}</a></li>
                        <li><a href="mailto:{{ config.email }}" class="hover:text-blue-500">{{ config.email }}</a></li>
                    </ul>
                </div>
                
                <div>
                     <h4 class="font-bold mb-4 text-slate-900 dark:text-white">Навигация</h4>
                     <ul class="space-y-2 text-gray-500 dark:text-gray-400 text-sm">
                        <li><a href="#admission" class="hover:text-blue-500 dark:hover:text-white">Поступление</a></li>
                        <li><a href="#programs" class="hover:text-blue-500 dark:hover:text-white">Программы</a></li>
                        <li><a href="#tuition" class="hover:text-blue-500 dark:hover:text-white">Гранты</a></li>
                        <li><a href="/admin/" class="hover:text-blue-500 dark:hover:text-white">Staff Login</a></li>
                     </ul>
                </div>
            </div>
            
            <div class="text-center text-gray-400 dark:text-gray-600 text-xs border-t border-gray-200 dark:border-gray-900 pt-8">
                &copy; 2026 Shakarim University. Designed with Future in mind.
            </div>
        </div>
    </footer>


    <!-- MODALS -->
    <!-- Consultation Modal -->
    <div id="consultationModal" class="fixed inset-0 z-[200] hidden flex items-center justify-center p-4">
        <!-- Backdrop -->
        <div class="absolute inset-0 bg-black/60 dark:bg-black/80 backdrop-blur-sm" onclick="closeModal('consultationModal')"></div>
        
        <div class="bg-white dark:bg-dark-900 border border-black/5 dark:border-white/10 w-full max-w-md p-8 rounded-2xl relative shadow-2xl z-10 transition-colors">
            <button onclick="closeModal('consultationModal')" class="absolute top-4 right-4 text-gray-400 hover:text-slate-900 dark:hover:text-white">✕</button>
            <h3 class="text-2xl font-bold mb-2 text-slate-900 dark:text-white">Оставить заявку</h3>
            <p class="text-gray-500 dark:text-gray-400 mb-6 text-sm">Менеджер свяжется с вами в течение 15 минут.</p>
            
            <form onsubmit="submitForm(event)" class="space-y-4">
                <input type="text" name="program" id="modalProgram" hidden>
                <div>
                    <input type="text" name="name" placeholder="Ваше Имя" required class="w-full bg-slate-50 dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none transition-colors text-slate-900 dark:text-white placeholder-gray-400">
                </div>
                <div>
                    <input type="tel" name="phone" placeholder="+7 (___) ___-__-__" required class="w-full bg-slate-50 dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none transition-colors text-slate-900 dark:text-white placeholder-gray-400">
                </div>
                <div>
                    <select name="level" class="w-full bg-slate-50 dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none transition-colors text-slate-900 dark:text-gray-300">
                        <option value="Bachelor" class="bg-white dark:bg-dark-800">Бакалавриат</option>
                        <option value="Master" class="bg-white dark:bg-dark-800">Магистратура</option>
                    </select>
                </div>
                <button type="submit" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 rounded-lg transition-colors">Отправить</button>
            </form>
        </div>
    </div>

    <!-- BROCHURE MODAL (Interactive) -->
<div x-data="{ open: false, p: {} }" 
@open-program-modal.window="open = true; p = $event.detail; document.body.style.overflow = 'hidden'" 
x-show="open" 
style="display: none;"
class="fixed inset-0 z-[100] overflow-y-auto"
aria-labelledby="modal-title" role="dialog" aria-modal="true">

<div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0">
   <div x-show="open" x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" class="fixed inset-0 transition-opacity bg-white/90 dark:bg-black/90 backdrop-blur-md" aria-hidden="true" @click="open = false; document.body.style.overflow = 'auto'"></div>
   <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>

   <!-- Modal Panel -->
   <div x-show="open" 
        x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95" x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100" x-transition:leave="ease-in duration-200" x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100" x-transition:leave-end="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95" 
        class="inline-block w-full max-w-6xl my-8 text-left align-middle transition-all transform bg-white dark:bg-dark-900 border border-black/5 dark:border-white/10 shadow-2xl rounded-3xl relative overflow-hidden">
       
        <!-- Close Button -->
        <button @click="open = false; document.body.style.overflow = 'auto'" class="absolute index-50 top-6 right-6 p-2 rounded-full bg-black/5 dark:bg-white/10 hover:bg-black/10 dark:hover:bg-white/20 text-slate-900 dark:text-white z-50 transition-colors">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
        </button>

        <!-- Content with Scroll -->
        <div class="max-h-[85vh] overflow-y-auto custom-scrollbar">
            <!-- Modal Header / Hero -->
            <div class="relative p-10 md:p-16 overflow-hidden">
                <div class="absolute inset-0 bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-900/40 dark:to-purple-900/40 z-0"></div>
                <div class="relative z-10">
                    <div class="flex flex-wrap gap-3 mb-6">
                         <span class="px-4 py-1.5 rounded-full bg-blue-500/10 dark:bg-blue-500/20 text-blue-600 dark:text-blue-300 border border-blue-500/20 dark:border-blue-500/30 text-sm font-bold tracking-wide" x-text="p.code"></span>
                         <span class="px-4 py-1.5 rounded-full bg-purple-500/10 dark:bg-purple-500/20 text-purple-600 dark:text-purple-300 border border-purple-500/20 dark:border-purple-500/30 text-sm font-bold tracking-wide" x-text="p.level"></span>
                    </div>
                    <h2 class="text-4xl md:text-6xl font-display font-bold text-slate-900 dark:text-white mb-6 leading-tight" x-text="p.title"></h2>
                    <p class="text-xl md:text-2xl text-blue-600 dark:text-blue-200 italic font-light" x-text="p.slogan"></p>
                </div>
            </div>

            <div class="grid lg:grid-cols-3 gap-0 border-t border-gray-200 dark:border-white/10">
                <!-- Sidebar -->
                <div class="lg:col-span-1 bg-gray-50 dark:bg-dark-800/50 p-8 border-r border-gray-200 dark:border-white/10 space-y-8">
                    <div>
                        <div class="text-xs uppercase tracking-widest text-gray-400 dark:text-gray-500 font-bold mb-2">Профильные Предметы</div>
                        <div class="text-xs font-bold text-slate-900 dark:text-white" x-text="p.unt_combination || p.unt_subjects || '---'"></div>
                    </div>

                    <div x-show="p.passing_score">
                        <div class="text-xs uppercase tracking-widest text-gray-400 dark:text-gray-500 font-bold mb-2">Проходной балл</div>
                        <div class="text-xl font-bold text-blue-600 dark:text-blue-400" x-text="p.passing_score"></div>
                    </div>
                    
                    <div>
                        <div class="text-xs uppercase tracking-widest text-gray-400 dark:text-gray-500 font-bold mb-2">Язык Обучения</div>
                        <div class="flex gap-2" x-show="p.languages">
                             <div x-show="p.languages.kaz" class="w-8 h-8 rounded bg-blue-500/10 dark:bg-blue-500/20 flex items-center justify-center text-blue-600 dark:text-blue-400 font-bold text-xs border border-blue-500/20 dark:border-blue-500/30">KZ</div>
                             <div x-show="p.languages.rus" class="w-8 h-8 rounded bg-red-500/10 dark:bg-red-500/20 flex items-center justify-center text-red-600 dark:text-red-400 font-bold text-xs border border-red-500/20 dark:border-red-500/30">RU</div>
                             <div x-show="p.languages.eng" class="w-8 h-8 rounded bg-purple-500/10 dark:bg-purple-500/20 flex items-center justify-center text-purple-600 dark:text-purple-400 font-bold text-xs border border-purple-500/20 dark:border-purple-500/30">EN</div>
                        </div>
                    </div>

                    <div x-show="p.salary">
                        <div class="text-xs uppercase tracking-widest text-gray-400 dark:text-gray-500 font-bold mb-2">Зарплата (Start)</div>
                        <div class="text-2xl font-display font-bold text-green-600 dark:text-green-400" x-text="p.salary"></div>
                    </div>

                    <div class="pt-8">
                        <button @click="closeModal('consultationModal'); openModal('consultationModal', p.title)" class="w-full py-4 rounded-xl bg-blue-600 hover:bg-blue-500 text-white font-bold shadow-lg shadow-blue-600/20 transition-all hover:scale-105">
                            Подать Заявку
                        </button>
                        <template x-if="p.brochureUrl">
                            <a :href="p.brochureUrl" target="_blank" class="block text-center mt-4 text-sm text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-white underline">Скачать PDF</a>
                        </template>
                    </div>
                </div>

                <!-- Main Content -->
                <div class="lg:col-span-2 p-8 md:p-12 space-y-12 bg-white dark:bg-dark-900">
                    <!-- About -->
                    <div>
                        <h4 class="text-xl font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-3">
                            <span class="w-1.5 h-6 bg-blue-500 rounded-full"></span>
                            О программе
                        </h4>
                        <p class="text-gray-600 dark:text-gray-300 leading-relaxed text-lg" x-text="p.main_info || p.description"></p>
                    </div>

                    <!-- What will learn -->
                    <div x-show="p.what_learn">
                        <h4 class="text-xl font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-3">
                            <span class="w-1.5 h-6 bg-purple-500 rounded-full"></span>
                            Чему научитесь
                        </h4>
                        <div class="prose dark:prose-invert max-w-none text-gray-600 dark:text-gray-300" x-text="p.what_learn"></div>
                    </div>

                    <!-- Advantages -->
                    <div x-show="p.advantages && p.advantages.some(a => a)">
                         <div class="grid sm:grid-cols-3 gap-4">
                            <template x-for="adv in p.advantages">
                                <div x-show="adv" class="bg-gray-50 dark:bg-white/5 p-4 rounded-xl border border-gray-200 dark:border-white/5">
                                    <p class="text-sm font-semibold text-blue-600 dark:text-blue-200" x-text="adv"></p>
                                </div>
                            </template>
                        </div>
                    </div>

                    <!-- Career & Skills Grid -->
                    <div class="grid md:grid-cols-2 gap-8">
                        <div x-show="p.hard_skills" class="bg-gray-50 dark:bg-dark-800 p-6 rounded-2xl border border-gray-200 dark:border-white/5">
                            <h5 class="font-bold text-slate-900 dark:text-white mb-3">Hard Skills</h5>
                            <p class="text-sm text-gray-600 dark:text-gray-400" x-text="p.hard_skills"></p>
                        </div>
                        <div x-show="p.soft_skills" class="bg-gray-50 dark:bg-dark-800 p-6 rounded-2xl border border-gray-200 dark:border-white/5">
                            <h5 class="font-bold text-slate-900 dark:text-white mb-3">Soft Skills</h5>
                            <p class="text-sm text-gray-600 dark:text-gray-400" x-text="p.soft_skills"></p>
                        </div>
                    </div>

                    <!-- Partners & Career Track -->
                    <div x-show="p.career_track" class="bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 p-8 rounded-2xl border border-blue-100 dark:border-white/5">
                        <h4 class="font-bold text-slate-900 dark:text-white mb-3">Карьерный трек</h4>
                        <p class="text-gray-600 dark:text-gray-300" x-text="p.career_track"></p>
                    </div>

                     <!-- People -->
                     <div x-show="p.star_graduates || p.star_teachers" class="grid md:grid-cols-2 gap-8 pt-6 border-t border-gray-200 dark:border-white/10">
                         <div x-show="p.star_graduates">
                             <div class="text-sm uppercase tracking-wider text-gray-400 dark:text-gray-500 font-bold mb-2">Наши Звезды</div>
                             <p class="text-slate-900 dark:text-white" x-text="p.star_graduates"></p>
                         </div>
                         <div x-show="p.star_teachers">
                            <div class="text-sm uppercase tracking-wider text-gray-400 dark:text-gray-500 font-bold mb-2">Преподаватели</div>
                            <p class="text-slate-900 dark:text-white" x-text="p.star_teachers"></p>
                        </div>
                     </div>
                </div>
            </div>
        </div>
   </div>
</div>
</div>

    <!-- Initialization Scripts -->
    <script>
        let vantaEffect;

        // Theme Management
        function initTheme() {
            // Default to light if no preference (force toggle to work as requested "Default white")
            if (localStorage.theme === 'dark') {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
                // Ensure default is explicit in local storage if needed, but 'else' covers it
            }
            initVanta();
        }

        function toggleTheme() {
             if (document.documentElement.classList.contains('dark')) {
                document.documentElement.classList.remove('dark');
                localStorage.theme = 'light';
            } else {
                document.documentElement.classList.add('dark');
                localStorage.theme = 'dark';
            }
            // Update Vanta background color
            initVanta();
        }

        // --- 1. VANTA 3D BACKGROUND ---
        function initVanta() {
            const isDark = document.documentElement.classList.contains('dark');
            
            // Destroy existing if present
            if (vantaEffect) vantaEffect.destroy();

            try {
                vantaEffect = VANTA.NET({
                    el: "#vanta-canvas",
                    mouseControls: true,
                    touchControls: true,
                    gyroControls: false,
                    minHeight: 200.00,
                    minWidth: 200.00,
                    scale: 1.00,
                    scaleMobile: 1.00,
                    color: 0x3b82f6,      // Blue points
                    backgroundColor: isDark ? 0x0f172a : 0xf8fafc, // dark-950 or slate-50
                    points: 12.00,
                    maxDistance: 22.00,
                    spacing: 16.00
                });
            } catch (e) {
                console.log("Vanta init error:", e);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
             initTheme();
        });

        // --- 2. GSAP ANIMATIONS ---
        gsap.registerPlugin(ScrollTrigger);

        // Hero Reveal
        gsap.from(".gs-reveal", {
            y: 50,
            opacity: 0,
            duration: 1.2,
            stagger: 0.2,
            ease: "power3.out"
        });

        // Steps Stagger
        gsap.from(".gs-step", {
            scrollTrigger: {
                trigger: "#admission",
                start: "top 70%",
            },
            y: 100,
            opacity: 0,
            duration: 0.8,
            stagger: 0.2,
            ease: "back.out(1.7)"
        });

        // Cards Stagger
        gsap.from(".gs-card", {
            scrollTrigger: {
                trigger: "#programs",
                start: "top 80%",
            },
            y: 50,
            opacity: 0,
            duration: 0.6,
            stagger: 0.1,
            ease: "power2.out"
        });

        // --- 3. DATA LOGIC (Preserved) ---
        const programsData = [
            {% for program in programs %}
            {
                id: "{{ program.id }}",
                title: `{{ program.title|escapejs }}`,
                code: `{{ program.code|escapejs }}`,
                level: `{{ program.get_level_display|escapejs }}`,
                description: `{{ program.description|escapejs }}`,
                main_info: `{{ program.main_info|escapejs }}`,
                unt_subjects: `{{ program.unt_subjects|escapejs }}`,
                unt_combination: `{{ program.unt_combination.title|default:''|escapejs }}`,
                passing_score: `{{ program.passing_score|default:''|escapejs }}`,
                languages: {
                    kaz: {{ program.lang_kaz|yesno:"true,false" }},
                    rus: {{ program.lang_rus|yesno:"true,false" }},
                    eng: {{ program.lang_eng|yesno:"true,false" }}
                },
                usp: `{{ program.usp|escapejs }}`,
                slogan: `{{ program.slogan|escapejs }}`,
                advantages: [
                    `{{ program.advantage_1|escapejs }}`,
                    `{{ program.advantage_2|escapejs }}`,
                    `{{ program.advantage_3|escapejs }}`
                ],
                target_audience: `{{ program.target_audience|escapejs }}`,
                career_track: `{{ program.career_track|escapejs }}`,
                partners: `{{ program.partners|escapejs }}`,
                salary: `{{ program.salary_start|escapejs }}`,
                what_learn: `{{ program.what_will_learn|escapejs }}`,
                hard_skills: `{{ program.hard_skills|escapejs }}`,
                soft_skills: `{{ program.soft_skills|escapejs }}`,
                social_proof: `{{ program.social_proof|escapejs }}`,
                graduates: `{{ program.star_graduates|escapejs }}`,
                teachers: `{{ program.star_teachers|escapejs }}`,
                brochureUrl: "{% if program.brochure %}{{ program.brochure.url }}{% endif %}"
            },
            {% endfor %}
        ];

        function openModal(id, programTitle = '') {
            document.getElementById(id).classList.remove('hidden');
            document.getElementById(id).classList.add('flex');
            if (programTitle && document.getElementById('modalProgram')) {
                document.getElementById('modalProgram').value = programTitle;
            }
        }
        
        function closeModal(id) {
            document.getElementById(id).classList.add('hidden');
            document.getElementById(id).classList.remove('flex');
        }

        async function submitForm(e) {
            e.preventDefault();
            const form = e.target;
            const data = Object.fromEntries(new FormData(form).entries());
            
            try {
                const button = form.querySelector('button');
                const originalText = button.innerText;
                button.innerText = 'Отправка...';
                
                const response = await fetch('/api/lead/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': '{{ csrf_token }}'
                    },
                    body: JSON.stringify(data)
                });
                const result = await response.json();
                if (result.status === 'success') {
                    alert('Заявка успешно отправлена! Мы скоро свяжемся с вами.');
                    closeModal('consultationModal');
                    form.reset();
                } else {
                    alert('Ошибка: ' + result.message);
                }
                button.innerText = originalText;
            } catch (err) {
                alert('Ошибка соединения');
            }
        }

        // Navbar Scroll Effect
        window.addEventListener('scroll', () => {
            const nav = document.getElementById('navbar');
            const isDark = document.documentElement.classList.contains('dark');
            if (window.scrollY > 50) {
                nav.classList.add('py-2');
                nav.classList.remove('py-4');
                nav.classList.add('shadow-md');
                // In light mode: white bg. In dark mode: dark.
                // We use utility classes in HTML or conditional logic here.
                // Since we rely on classes like `glass-nav` which are handled by CSS with .dark, 
                // we just toggle the glass-nav vs solid bg if we wanted.
                // But glass-nav handles both well if configured.
                // Let's force a background for readability on scroll.
                if (isDark) {
                    nav.classList.add('bg-dark-900/95');
                } else {
                    nav.classList.add('bg-white/95');
                }
                nav.classList.remove('glass-nav');
            } else {
                nav.classList.add('py-4');
                nav.classList.remove('py-2');
                nav.classList.remove('shadow-md');
                nav.classList.remove('bg-dark-900/95');
                nav.classList.remove('bg-white/95');
                nav.classList.add('glass-nav');
            }
        });
    </script>
</body>
</html>
